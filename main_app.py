"""
力学振动数据一致性分析系统 - 主页面
集成一致性分析和相似度分析两大功能模块
"""

import streamlit as st

# 页面配置
st.set_page_config(
    page_title="力学振动数据一致性分析系统",
    page_icon="📊",
    layout="wide",
    initial_sidebar_state="expanded"
)

# 应用标题
st.title("📊 力学振动数据一致性分析系统")
st.markdown("---")

# 功能介绍
st.markdown("""
### 🎯 系统功能概述

本系统集成了三个核心分析模块，为力学振动数据提供全面的分析解决方案：

#### 1. **频谱分析模块** 📈
- **新数据 vs 参考集对比**：将新的未经处理数据与参考数据集进行对比分析
- **频谱可视化**：新数据高亮显示，参考集虚化处理
- **选定频段分析**：在特定频率范围内进行详细对比
- **实时测点切换**：支持快速切换不同测点查看分析结果

#### 2. **相似度分析模块** 🔍  
- **Esim相似度计算**：基于线性插值的相似度分析
- **多维度可视化**：X/Y/Z方向分别显示相似度结果
- **智能颜色标记**：自动识别并标记低相似度测点
- **选定频段分析**：针对特定频率范围进行深度分析

#### 3. **数据转换模块** 🔄
- **LMS数据预处理**：将原始LMS导出文件转换为特征级数据格式
- **批量处理**：支持同时处理多个文件
- **自动格式转换**：提取有效测点数据，去除冗余元数据
- **一键下载**：提供单个文件或批量打包下载

### 🚀 快速开始

请从左侧边栏选择您需要的分析模块开始使用。
""")

# 侧边栏导航
st.sidebar.header("🧭 导航")
analysis_module = st.sidebar.radio(
    "选择分析模块",
    ["频谱分析", "相似度分析", "数据转换"],
    index=0,
    help="选择要使用的分析模块"
)

# 根据选择跳转到相应页面
if analysis_module == "频谱分析":
    st.switch_page("pages/consistency_analysis.py")
elif analysis_module == "相似度分析":
    st.switch_page("pages/similarity_analysis.py")
elif analysis_module == "数据转换":
    st.switch_page("pages/data_converter.py")

# 使用说明
with st.expander("📖 详细使用说明"):
    st.markdown("""
    ### 数据格式要求

    #### 一致性分析模块
    - **新数据**：原始LMS导出Excel文件（包含第12行测点名）
    - **参考数据**：已处理的特征级Excel文件（第一列为频率）

    #### 相似度分析模块
    - **处理数据**：已转换的特征级Excel文件
    - **测点位置表**：包含测点舱板和单机区域分布信息（可选）

    ### 分析流程

    1. **选择分析模块**：根据需求选择一致性分析或相似度分析
    2. **上传数据文件**：按照模块要求上传相应格式的数据
    3. **配置分析参数**：设置频率范围、显示风格等参数
    4. **查看分析结果**：实时查看图表和数据分析结果
    5. **下载结果**：导出分析图表和数据表格

    ### 技术支持

    如遇技术问题，请检查：
    - 文件格式是否符合要求
    - 数据完整性是否满足分析需求
    - 网络连接是否稳定
    """)

# 页脚信息
st.markdown("---")
st.caption("力学振动数据一致性分析系统 | 基于Streamlit开发 | 集成一致性分析与相似度分析")
