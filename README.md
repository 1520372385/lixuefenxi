# 力学振动数据一致性分析系统

基于Streamlit开发的力学振动数据一致性分析系统，包含两个主要功能模块：一致性分析和相似度分析。

## 系统架构

```
yizhixing/
├── main_app.py              # 主页面 - 导航入口
├── pages/
│   ├── consistency_analysis.py    # 一致性分析模块
│   └── similarity_analysis.py     # 相似度分析模块
├── utils.py                 # 共享工具函数
├── requirements.txt         # 依赖包列表
└── README.md               # 说明文档
```

## 功能模块

### 1. 一致性分析模块 (consistency_analysis.py)

**主要功能：**
- 新数据与参考集的对比分析
- 完整的测点切换功能（左右按钮导航）
- 频谱曲线绘制和选定频段叠加
- 参考集数据虚化显示
- 单个文件下载功能

**数据要求：**
- 新数据：未经处理的LMS数据（.xlsx/.xls），自动转换
- 参考数据：已处理的特征级Excel文件（第一列为频率）

### 2. 相似度分析模块 (similarity_analysis.py)

**主要功能：**
- Esim相似度分析
- 完整的测点切换功能（左右按钮导航）
- 颜色标记功能（红色：<0.8，黄色：0.8-0.9）
- 测点位置信息显示
- 频谱分析和相似度可视化

**数据要求：**
- 振动数据Excel文件（多工作表，第一列为频率）
- 测点位置表（可选，包含舱板和单机区域信息）

## 安装和运行

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 运行系统
```bash
cd yizhixing
streamlit run main_app.py
```

### 3. 访问系统
打开浏览器访问：`http://localhost:8501`

## 使用说明

### 一致性分析模块

1. **上传数据**
   - 上传新的未经处理的LMS数据（可多选）
   - 上传参考数据（已处理的特征级Excel文件）

2. **数据转换**
   - 点击"开始转换并缓存"按钮转换新数据
   - 点击"读取参考数据"按钮加载参考数据

3. **频谱分析**
   - 使用下拉菜单和左右按钮切换测点
   - 查看新数据高亮、参考数据虚化的频谱图

4. **频段分析**
   - 设置起始和终止频率
   - 查看选定频段的频谱叠加和差值比较

### 相似度分析模块

1. **上传数据**
   - 上传振动数据Excel文件
   - 上传测点位置表（可选）

2. **选择分析类型**
   - 频谱分析：查看原始频谱图
   - 相似度分析：进行Esim相似度计算

3. **测点导航**
   - 使用下拉菜单和左右按钮切换测点
   - 查看带颜色标记的测点列表

4. **相似度分析结果**
   - 查看相似度矩阵表格
   - 识别低相似度测点（<0.8和0.8-0.9）
   - 使用颜色标记功能标红/标黄测点

## 技术特点

- **完整的测点切换**：所有模块都支持左右按钮导航测点
- **数据可视化**：使用Plotly进行交互式图表展示
- **颜色标记**：根据相似度结果自动标记测点
- **数据下载**：支持图表和数据结果下载
- **模块化设计**：代码结构清晰，易于维护扩展

## 文件结构说明

- `main_app.py`：系统入口，提供模块导航
- `pages/consistency_analysis.py`：一致性分析功能
- `pages/similarity_analysis.py`：相似度分析功能  
- `utils.py`：共享工具函数，避免代码重复
- `requirements.txt`：Python依赖包列表

## 注意事项

1. 确保所有Excel文件格式正确
2. 测点名称格式应为：XM1, YM2, ZM3等
3. 频率数据应在第一列
4. 建议使用最新版本的依赖包
5. 系统会自动缓存数据以提高性能

## 开发说明

系统基于Streamlit框架开发，支持多页面应用模式。所有页面都通过`st.switch_page()`进行导航，确保良好的用户体验。
